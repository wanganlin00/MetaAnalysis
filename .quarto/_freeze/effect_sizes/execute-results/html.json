{
  "hash": "65a413c84dc5099b634599bdbc8583fc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"效应大小\"\n---\n\n\n\n\n效应大小（effect sizes）+标准误\n\n## 观察性研究\n\n### 算术均值\n\n$$\n\\bar x =\\frac{\\sum_{i=1}^n x_i}{n}\n$$\n\n$$\nSE_{\\bar x} = \\frac{s}{\\sqrt{n}} \n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\nsample <- rnorm(n = 50, mean = 20, sd = 5)\nmean(sample)\n#> [1] 20.17202\nsd(sample)/sqrt(50)\n#> [1] 0.6546889\n```\n:::\n\n\n\n\n要对均值进行荟萃分析，我们的数据集至少应包含以下列：\n\n-   **`n`** 研究中观测值的数量 （样本量）。\n\n-   **`mean`** 研究中报告的平均值。\n\n-   **`sd`** 研究中报告的变量的标准差。\n\n### 比例\n\n$$\np=\\frac{k}{n}\n$$\n\n$$\nSE_{p} = \\sqrt{\\frac{p(1-p)}{n}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nk <- 25\nn <- 125\n\np <- k/n\np\n#> [1] 0.2\n\nsqrt((p*(1-p))/n)\n#> [1] 0.03577709\n```\n:::\n\n\n\n\nlogit 转换确保采样分布大致正态\n\n$$\np_{\\text{logit}} = \\log_{e} \\left(\\frac{p}{1-p}\\right)\n$$\n\n$$\nSE_{p_{\\text{logit}}} = \\sqrt{\\frac{1}{np}+\\frac{1}{n(1-p)}}\n$$\n\n*R* 中使用的元分析函数会自动执行这种 logit 转换\n\n我们的数据集至少应包含以下列：\n\n-   **`n`** 研究中的总样本量。\n\n-   k 研究中指定亚组的样本量。\n\n### 相关性\n\n#### **Pearson Product-Moment Correlation**\n\n两个连续变量\n\n$$\nr_{xy} = \\frac{\\sigma^{2}_{xy}}{\\sigma_x \\sigma_y}\n$$\n\n$$\nSE_{r_{xy}} = \\frac{1-r_{xy}^2}{\\sqrt{n-2}}\n$$\n\n-   r≈0.10：效果小。\n\n-   r≈0.30：中等效果。\n\n-   r≈0.50：大效果。\n\n在元分析中，相关性通常转化为 ***Fisher's z***\n\n$$\nz = 0.5\\log_{e}\\left(\\frac{1+r}{1-r}\\right)\n$$\n\n$$\nSE_{z} = \\frac{1}{\\sqrt{n-3}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(12345)\nx <- rnorm(20, 50, 10)\ny <- rnorm(20, 10, 3)\n\nr <- cor(x,y)\nr\n#> [1] 0.2840509\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nz <- 0.5*log((1+r)/(1-r))\nz\n#> [1] 0.2920831\n```\n:::\n\n\n\n\n在 *R* 中对相关性进行荟萃分析时手动转换。我们在数据集中唯一需要的列是：\n\n-   **`COR`** 研究的（未转换的）相关系数。\n\n-   **`n`**. 研究的样本量。\n\n#### **Point-Biserial Correlation**\n\ny是连续变量，x是二分类变量\n\n$$\n{r_{pb}}= \\frac{(\\bar{y_1}-\\bar{y_2})\\sqrt{p_1(1-p_1)}}{s_y}\n$$\n\n## 实验性研究\n\n### **(Standardized) Mean Differences**\n\n#### **组间均值差值**\n\n$$\n\\text{MD}_{\\text{between}} = \\bar{x}_1 - \\bar{x}_2\n$$\n\n$$\nSE_{\\text{MD}_{\\text{between}}} = s_{\\text{pooled}}\\sqrt{\\frac{1}{n_1}+\\frac{1}{n_2}}\n$$\n\n其中，$s_{pooled}$ 表示两组的合并标准差\n\n$$\ns_{\\text{pooled}} = \\sqrt{\\frac{(n_1-1)s^2_1+(n_2-1)s^2_2}{(n_1-1)+(n_2-1)}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\nx1 <- rnorm(n = 20, mean = 10, sd = 3)\nx2 <- rnorm(n = 20, mean = 15, sd = 3)\n\ns1 <- sd(x1)\ns2 <- sd(x2)\nn1 <- 20\nn2 <- 20\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the mean difference\nMD <- mean(x1) - mean(x2)\nMD\n#> [1] -4.421357\n\n# Calculate s_pooled\ns_pooled <- sqrt(\n  (((n1-1)*s1^2) + ((n2-1)*s2^2))/\n    ((n1-1)+(n2-1))\n)\n\n# Calculate the standard error\nse <- s_pooled*sqrt((1/n1)+(1/n2))\nse\n#> [1] 0.8577262\n```\n:::\n\n\n\n\n对于均差的荟萃分析，我们只需要在数据集中准备以下列：\n\n-   **`n.e`**. 干预/实验组中的观察值数量。\n\n-   **`mean.e`**. 干预/实验组的平均值。\n\n-   **`sd.e`**. 干预/实验组的标准差。\n\n-   **`n.c`**. 对照组中的观测值个数。\n\n-   **`mean.c`**. 对照组的均值。\n\n-   **`sd.c`**. 控制组中的标准差。\n\n#### **组间标准化均值差值**\n\n在文献中，标准化均值差也通常称为 *`Cohen's d` 。*\n\n$$\n\\text{SMD}_{\\text{between}} = \\frac{\\bar{x}_1 - \\bar{x}_2}{s_{\\text{pooled}}}\n$$\n\n通常使用 Cohen （[1988](https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/references.html#ref-cohen1988statistical)） 的约定进行解释：\n\n-   SMD ≈ 0.20: small effect.\n\n-   SMD ≈ 0.50: moderate effect.\n\n-   SMD ≈ 0.80: large effect.\n\n$$\nSE_{\\text{SMD}_{\\text{between}}} = \\sqrt{\\frac{n_1+n_2}{n_1n_2} + \\frac{\\text{SMD}^2_{\\text{between}}}{2(n_1+n_2)}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(esc)\n\n# This is just some example data that we made up\ngrp1m <- 50   # mean of group 1\ngrp2m <- 60   # mean of group 2\ngrp1sd <- 10  # sd of group 1\ngrp2sd <- 10  # sd of group 2\ngrp1n <- 100  # n of group1\ngrp2n <- 100  # n of group2\n\n# Calculate effect size\nesc_mean_sd(grp1m = grp1m, grp2m = grp2m, \n            grp1sd = grp1sd, grp2sd = grp2sd, \n            grp1n = grp1n, grp2n = grp2n)\n#> \n#> Effect Size Calculation for Meta Analysis\n#> \n#>      Conversion: mean and sd to effect size d\n#>     Effect Size:  -1.0000\n#>  Standard Error:   0.1500\n#>        Variance:   0.0225\n#>        Lower CI:  -1.2940\n#>        Upper CI:  -0.7060\n#>          Weight:  44.4444\n```\n:::\n\n\n\n\n**小样本校正，Hedges’g**\n\n要对标准化均数差进行荟萃分析，我们的数据集至少应包含以下列：\n\n-   **`n.e`**. 干预/实验组中的观察值数量。\n\n-   **`mean.e`**. 干预/实验组的平均值。\n\n-   **`sd.e`**. 干预/实验组的标准差。\n\n-   **`n.c`**. 对照组中的观测值个数。\n\n-   **`mean.c`**. 对照组的均值。\n\n-   **`sd.c`**. 控制组中的标准差。\n\n#### **组内（标准化）均值差值**\n\n当在两个不同的时间点（例如，干预前和干预后）测量同一组人时，通常会出现这种情况。\n\n$$\n\\text{MD}_{\\text{within}} = \\bar{x}_{\\text{t}_2} - \\bar{x}_{\\text{t}_1}\n$$\n\n### (对数)风险比\n\n|           | Event | No Event |               |\n|:---------:|:-----:|:---------|---------------|\n| Treatment |   a   | b        | n treatntreat |\n|  Control  |   c   | d        | n control     |\n|           |  n E  | n¬E      |               |\n\n$$\n{p_{E}}_{\\text{treat}} = \\frac{a}{a+b} = \\frac{a}{n_{\\text{treat}}}\n$$\n\n$$\n{p_{E}}_{\\text{control}} = \\frac{c}{c+d} = \\frac{c}{n_{\\text{control}}}\n$$\n\n$$\n\\text{RR} = \\frac{{p_{E}}_{\\text{treat}}}{{p_{E}}_{\\text{control}}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define data\na <- 46         # events in the treatment group\nc <- 77         # events in the control group\nn_treat <- 248  # sample size treatment group\nn_contr <- 251  # sample size control group\n\n# Calculate the risks\np_treat <- a/n_treat\np_contr <- c/n_contr\n\n# Calculate the risk ratio\nrr <- p_treat/p_contr\nrr\n#> [1] 0.6046292\n```\n:::\n\n\n\n\nlog-risk ratio\n\n$$\n\\log \\text{RR}  = \\log_{e}(\\text{RR})\n$$\n\n$$\nSE_{\\log \\text{RR}} = \\sqrt{\\frac{1}{a}+\\frac{1}{c} - \\frac{1}{a+b} - \\frac{1}{c+d}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the log-risk ratio and its standard error\nlog_rr <- log(rr)\nlog_rr\n#> [1] -0.5031398\n\nse_log_rr <- sqrt((1/a) + (1/c) - (1/n_treat) - (1/n_contr))\nse_log_rr\n#> [1] 0.1634314\n```\n:::\n\n\n\n\ncontinuity correction\n\ntreatment arm continuity correction\n\n(fixed-effect) Mantel-Haenszel method\n\n我们的数据集中应包含以下列：\n\n-   **`event.e`**. 处理组或实验组中的事件数。\n\n-   **`n.e`**. 处理组或实验组的样本量。\n\n-   **`event.c`**. 控制组中的事件数。\n\n-   **`n.c`**. 对照组的样本量。\n\n### 比值比\n\n$$\n\\text{OR} = \\frac{a/b}{c/d}\n$$\n\n$$\n\\log \\text{OR}  = \\log_{e}(\\text{OR})\n$$\n\n$$\nSE_{\\log \\text{OR}}  = \\sqrt{\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{1}{d}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(esc)\n\n# Define data\ngrp1yes <- 45  # events in the treatment group\ngrp1no <- 98   # non-events in the treatment group\ngrp2yes <- 67  # events in the control group\ngrp2no <- 76   # non-events in the control group\n\n# Calculate OR by setting es.type to \"or\"\nesc_2x2(grp1yes = grp1yes, grp1no = grp1no,\n        grp2yes = grp2yes, grp2no = grp2no,\n        es.type = \"or\")\n#> \n#> Effect Size Calculation for Meta Analysis\n#> \n#>      Conversion: 2x2 table (OR) coefficient to effect size odds ratio\n#>     Effect Size:   0.5209\n#>  Standard Error:   0.2460\n#>        Variance:   0.0605\n#>        Lower CI:   0.3216\n#>        Upper CI:   0.8435\n#>          Weight:  16.5263\n```\n:::\n\n\n\n\n$$\n\\text{RR} = \\frac{\\text{OR}}{\\left(1-\\dfrac{c}{n_{\\text{control}}}\\right)+ \\left(\\dfrac{c}{n_{\\text{control}}}\\times \\text{OR} \\right)}\n$$\n\n为了对 *R* 中的比值比进行荟萃分析，我们的数据集中应包括以下列：\n\n-   **`event.e`**. 处理组或实验组中的事件数。\n\n-   **`n.e`**. 处理组或实验组的样本量。\n\n-   **`event.c`**. 控制组中的事件数。\n\n-   **`n.c`**. 对照组的样本量。\n\n### **发病率比 Incidence Rate Ratios**\n\n## 校正\n\n### 小样本偏倚\n\nHedges’g\n\n$$\ng = \\text{SMD} \\times (1-\\frac{3}{4n-9})\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load esc package\nlibrary(esc)\n\n# Define uncorrected SMD and sample size n\nSMD <- 0.5\nn <- 30\n\n# Convert to Hedges g\ng <- hedges_g(SMD, n)\ng\n#> [1] 0.4864865\n```\n:::\n\n\n\n\n### 不可靠\n\nreliability coefficient `rxx` test-retest-reliability\n\nHunter 和 Schmidt 方法 attenuation\n\n计算相关性的校正版本\n\n$$\n{r_{xy}}_{c} = \\frac{r_{xy}}{\\sqrt{r_{xx}}}\n$$\n\n$$\n{r_{xy}}_{c} = \\frac{r_{xy}}{\\sqrt{r_{xx}}\\sqrt{r_{yy}}}\n$$\n\n当结果x在两组中观察到\n\n$$\n\\text{SMD}_c = \\frac{\\text{SMD}}{\\sqrt{r_{xx}}}\n$$\n\n标准误的校正\n\n$$\nSE_c = \\frac{SE}{\\sqrt{r_{xx}}}\n$$\n\n$$\nSE_c = \\frac{SE}{\\sqrt{r_{xx}}\\sqrt{r_{yy}}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define uncorrected correlation and SMD with their standard error\nr_xy <- 0.34\nse_r_xy <- 0.09\nsmd <- 0.65\nse_smd <- 0.18\n\n# Define reliabilities of x and y\nr_xx <- 0.8\nr_yy <- 0.7\n\n# Correct SMD for unreliability in x\nsmd_c <- smd/sqrt(r_xx)\nsmd_c\n#> [1] 0.7267221\n\nse_c <- se_smd/sqrt(r_xx)\nse_c\n#> [1] 0.2012461\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Correct correlation for unreliability in x and y\nr_xy_c <- r_xy/(sqrt(r_xx)*sqrt(r_yy))\nr_xy_c\n#> [1] 0.4543441\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nse_c <- se_r_xy/(sqrt(r_xx)*sqrt(r_yy))\nse_c\n#> [1] 0.1202676\n```\n:::\n\n\n\n\n### 范围限制\n\n$$\nU =  \\frac{s_{\\text{unrestricted}}}{s_{\\text{restricted}}}\n$$\n\n$$\n{r_{xy}}_c = \\frac{U\\times r_{xy}}{\\sqrt{(U^2-1)r_{xy}^2+1}}\n$$\n\n$$\n\\text{SMD}_c = \\frac{U\\times \\text{SMD}}{\\sqrt{(U^2-1)\\text{SMD}^2+1}}\n$$\n\n$$\nSE_{{r_{xy}}_c} = \\frac{{r_{xy}}_c}{r_{xy}}SE_{r_{xy}}\n$$\n\n$$\nSE_{{\\text{SMD}}_c} = \\frac{{\\text{SMD}}_c}{\\text{SMD}}SE_{\\text{SMD}}\n$$\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define correlation to correct\nr_xy <- 0.34\nse_r_xy <- 0.09\n\n# Define restricted and unrestricted SD\nsd_restricted <- 11\nsd_unrestricted <- 18\n\n# Calculate U\nU <- sd_unrestricted/sd_restricted\n\n# Correct the correlation\nr_xy_c <- (U*r_xy)/sqrt((U^2-1)*r_xy^2+1)\nr_xy_c\n#> [1] 0.5091754\n\n# Correct the standard error\nse_r_xy_c <- (r_xy_c/r_xy)*se_r_xy\nse_r_xy_c\n#> [1] 0.1347817\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}